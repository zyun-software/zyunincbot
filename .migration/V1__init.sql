CREATE TABLE users (
  id BIGINT PRIMARY KEY NOT NULL,
  nickname VARCHAR(16) UNIQUE NOT NULL,
  emoji TEXT,
  business_name TEXT,
  api TEXT DEFAULT NULL,
  admin BOOLEAN DEFAULT FALSE NOT NULL,
  banned BOOLEAN DEFAULT FALSE NOT NULL
);

INSERT INTO users (id, nickname, admin, emoji, business_name)
VALUES
  (494209756, 'Ziozyun', TRUE, NULL, NULL),
  (873687184, 'Kyryl_Kruhliak', FALSE, NULL, NULL),
  (5300000961, 'Capybarsk', FALSE, 'üåÉ', '–ö–∞–ø—ñ–±–∞—Ä—Å—å–∫'),
  (543592260, 'Han__Salo', FALSE, NULL, NULL);

CREATE TABLE quotes (
  id BIGSERIAL PRIMARY KEY NOT NULL,
  text TEXT NOT NULL
);

INSERT INTO quotes (text)
VALUES
  ('–ì—Ä–æ—à—ñ - —Ü–µ —î–¥–∏–Ω–µ, —â–æ —Ç–∏ –º–æ–∂–µ—à –≤—Ç—Ä–∞—Ç–∏—Ç–∏, —ñ–Ω—à–æ–≥–æ –≤–∞—Ä—ñ–∞–Ω—Ç—É –Ω–µ–º–∞—î!'),
  ('–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Å—Ç–∞–Ω –º–µ–Ω–µ –Ω–µ —Ç—É—Ä–±—É—î - —É –º–µ–Ω–µ –π–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ–º–∞—î!'),
  ('–Ø–∫—â–æ –≤–∏ –¥—É–º–∞—î—Ç–µ, —â–æ –≥—Ä–æ—à—ñ –Ω–µ –º–æ–∂—É—Ç—å –∫—É–ø–∏—Ç–∏ —â–∞—Å—Ç—è, —Å–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–ø–ª–∞—Ç–∏—Ç–∏ —Ä–∞—Ö—É–Ω–æ–∫ –∑–∞ –ª—ñ–∫—É–≤–∞–Ω–Ω—è.'),
  ('–ú—ñ–π –±–∞–Ω–∫—ñ–≤—Å—å–∫–∏–π —Ä–∞—Ö—É–Ω–æ–∫ - —Ü–µ —è–∫ –º–æ—è –¥—ñ–≤—á–∏–Ω–∞, —è –∑–∞–≤–∂–¥–∏ –∑ –Ω–∏–º —Å–ø–µ—Ä–µ—á–∞—é—Å—è.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ –∫–æ–ª–∏ —Ç–∏ –æ–±–∏—Ä–∞—î—à –º—ñ–∂ –ø–ª–∞—Ç–∏—Ç–∏ –∑–∞ –æ—Ä–µ–Ω–¥—É –∞–±–æ –∫—É–ø—É–≤–∞—Ç–∏ –ø—ñ—Ü—Ü—É. –ü—ñ—Ü—Ü–∞ –∑–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–º–∞–≥–∞—î!'),
  ('–£ –º–µ–Ω–µ —î –¥–≤–∞ –≤–∏–¥–∏ –ª—é–¥–µ–π: —Ç—ñ, —É –∫–æ–≥–æ —î –≥—Ä–æ—à—ñ, —ñ —Ç—ñ, —Ö—Ç–æ –ø–ª–∞—Ç–∏—Ç—å –∑–∞ –ø—ñ—Ü—Ü—É.'),
  ('–Ø–∫—â–æ –≤–∞—à—ñ —Ñ—ñ–Ω–∞–Ω—Å–∏ –Ω–µ –≤–∏–≥–ª—è–¥–∞—é—Ç—å —è–∫ –±—ñ–∑–Ω–µ—Å-–ø–ª–∞–Ω –Ω–∞—Ä–∫–æ—Ç–æ—Ä–≥–æ–≤—Ü—è, –≤–∏ —Ä–æ–±–∏—Ç–µ —ó—Ö –Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.'),
  ('–ó–∞–ø–∞—Å–∞–π—Ç–µ—Å—è –≥—Ä–æ—à–∏–º–∞, –±–æ —É –∫—ñ–Ω—Ü—ñ –º—ñ—Å—è—Ü—è –≤–æ–Ω–∏ –¥–æ–≤–æ–ª—ñ —Ä—ñ–¥–∫—ñ—Å–Ω—ñ.'),
  ('–ó–∞–≤–∂–¥–∏ –¥—É–º–∞–π—Ç–µ –ø—Ä–æ –≥—Ä–æ—à—ñ, –∞–ª–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≥–æ–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ –Ω–∏—Ö. –í–æ–Ω–∏ —á—É—é—Ç—å –≤–∞—Å!'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ —è–∫ –∑–∞–±–∞–≤–∫–∞ –¥–ª—è –¥–æ—Ä–æ—Å–ª–∏—Ö, –¥–µ –ø—Ä–∞–≤–∏–ª–∞ –≥—Ä–∏ –∑–¥–∞—é—Ç—å—Å—è –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–∏–º–∏, –∞ –≤—Å—ñ –∑–¥–æ—Ä–æ–≤–æ –≤–∏–≥—Ä–∞—é—Ç—å –≥–æ–ª–æ–≤–Ω–∏–π –ø—Ä–∏–∑ - –ø–æ–¥–∞—Ç–∫–∏!'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ –∫–æ—Ä—ñ–Ω—å –≤—Å—å–æ–≥–æ –∑–ª–∞, –∞–ª–µ –≤–æ–Ω–∏ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è –æ–ø–ª–∞—Ç–∏ —Ä–∞—Ö—É–Ω–∫—ñ–≤.'),
  ('–§—ñ–Ω–∞–Ω—Å–æ–≤–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å - —Ü–µ –∫–æ–ª–∏ –≤–∞—à—ñ –≥—Ä–æ—à—ñ —Ä–æ–±–ª—è—Ç—å –±—ñ–ª—å—à–µ –≥—Ä–æ—à–µ–π, –Ω—ñ–∂ –≤–∏.'),
  ('–Ø–∫—â–æ –≥—Ä–æ—à—ñ –∑—Ä–æ–±–∏–ª–∏ –± —â–∞—Å–ª–∏–≤–∏–º–∏, –≤—Å—ñ –± –±—É–ª–∏ –± —â–∞—Å–ª–∏–≤—ñ, –∫—É–ø–∏–≤—à–∏ –ø—ñ—Ü—Ü—É.'),
  ('–ú–æ—ó —Ñ—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ –º–æ–≤–∞, —è–∫–æ—é —è –Ω–µ —Ä–æ–∑–º–æ–≤–ª—è—é.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ —Ç–µ, —â–æ —Ç–∏ –æ—Ç—Ä–∏–º—É—î—à, –∫–æ–ª–∏ —Ç–∏ –Ω–µ –æ—Ç—Ä–∏–º—É—î—à —â–æ—Å—å –∫—Ä–∞—â–µ.'),
  ('–Ø–∫—â–æ –± –¥—ñ—Ç–∏ –≤–∏—Ç—Ä–∞—á–∞–ª–∏ –≥—Ä–æ—à—ñ —Ç–∞–∫, —è–∫ –º–æ—è –¥—Ä—É–∂–∏–Ω–∞, –º–∏ –± –∂–∏–ª–∏ –≤ —ñ–Ω—à—ñ–π –∫—Ä–∞—ó–Ω—ñ.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ —Ç–∞ –≥—Ä–∞, –¥–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–º—ñ–Ω—é—é—Ç—å—Å—è, –∞ –∫–µ—Ä–º–∞–Ω–∏ –Ω–∞—à–æ—ó –∑–∞—Ä–ø–ª–∞—Ç–∏ - —Ü–µ –≤–∂–µ –Ω–µ –±–∞–≥–∞—Ç–æ –ø–∞–ø–µ—Ä—ñ–≤.'),
  ('–Ø –¥—ñ–∑–Ω–∞–≤—Å—è, —â–æ –≥—Ä–æ—à—ñ –Ω–µ –º–æ–∂—É—Ç—å –∫—É–ø–∏—Ç–∏ —â–∞—Å—Ç—è, –∫–æ–ª–∏ —è –≤–∏—Ä—ñ—à–∏–≤ –∫—É–ø–∏—Ç–∏ –Ω–æ–≤–∏–π —ñ—Ñ–æ–Ω –∑–∞–º—ñ—Å—Ç—å —Ç–æ—Ä—Ç–∞.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ —è–∫ –ø—ñ–¥—Ä—É—á–Ω–∏–∫ –≥–µ–æ–≥—Ä–∞—Ñ—ñ—ó: –º–∏ –∑–∞–≤–∂–¥–∏ –∑–Ω–∞—î–º–æ, –¥–µ —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –Ω–∞—à—ñ –≥—Ä–æ—à—ñ.'),
  ('–í–∏—Ä–∞–∑ "—Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —É—Å–ø—ñ—Ö" –æ–∑–Ω–∞—á–∞—î —Ç–µ, –∫–æ–ª–∏ –≤–∏ –º–∞—î—Ç–µ –¥–µ–∫—ñ–ª—å–∫–∞ –¥–æ–ª–∞—Ä—ñ–≤ —É –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–º—É —Ä–∞—Ö—É–Ω–∫—É —ñ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –≤–∏–≥–ª—è–¥–∞—Ç–∏ —è–∫ –º—ñ–ª—å–π–æ–Ω–µ—Ä.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ –∫–æ–ª–∏ –≥—Ä–æ—à—ñ –∑–∞–ª–∏—à–∞—é—Ç—å —Ç–≤–æ—é –∫–∏—à–µ–Ω—é —Ç–∞–∫ —à–≤–∏–¥–∫–æ, —è–∫ —Ç–∏ –∑–∞—Ö–æ–¥–∏—à —É –º–∞–≥–∞–∑–∏–Ω.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ —Ç—ñ–ª—å–∫–∏ —Ü–∏—Ñ—Ä–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ, –∞–ª–µ –≤–æ–Ω–∏ –¥—É–∂–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –º–æ—î –µ–º–æ—Ü—ñ–π–Ω–µ —Å—Ç–∞–Ω–æ–≤–∏—â–µ.'),
  ('–§—ñ–Ω–∞–Ω—Å–æ–≤–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å - —Ü–µ —Ç–æ–π –º–æ–º–µ–Ω—Ç, –∫–æ–ª–∏ —Ç–≤–æ—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –¥–æ —Ç–µ–±–µ, –∞ –Ω–µ –¥–æ —Ä–∞—Ö—É–Ω–∫—ñ–≤ —ñ –∫—Ä–µ–¥–∏—Ç–æ—Ä—ñ–≤.'),
  ('–ì—Ä–æ—à—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º–æ—é, –∞–ª–µ –≤–æ–Ω–∏ —Ç–∞–∫–æ–∂ —Ä–æ–∑–≤''—è–∑—É—é—Ç—å –±–∞–≥–∞—Ç–æ –ø—Ä–æ–±–ª–µ–º, –æ—Å–æ–±–ª–∏–≤–æ —Ç—ñ, —è–∫—ñ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –≥—Ä–æ—à–µ–π.'),
  ('–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π –ø–æ—Ä–∞–¥–Ω–∏–∫ - —Ü–µ –ª—é–¥–∏–Ω–∞, —è–∫–∞ –±–µ—Ä–µ –≥—Ä–æ—à—ñ –∑–∞ —Ç–µ, —â–æ–± —Å–∫–∞–∑–∞—Ç–∏ –≤–∞–º, —â–æ –≤–∏ –≤–∂–µ –≤–∏—Ç—Ä–∞—Ç–∏–ª–∏ —ó—Ö –∑–∞–π–≤–∏–π —Ä–∞–∑.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ —Ç–µ, —â–æ —Ä–æ–±–∏—Ç—å —Å–≤—ñ—Ç –æ–±–µ—Ä–Ω–µ–Ω–∏–º —Å—ñ—Ä–∏–º –º—ñ—Å—Ü–µ–º, –±—É–∫–≤–∞–ª—å–Ω–æ —ñ —Ñ—ñ–≥—É—Ä–∞–ª—å–Ω–æ.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ —Ç–µ, —â–æ –∑–º—É—à—É—î —Ç–µ–±–µ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞—Ç–∏ —Å–ø—Ä–∞–≤–∏ –∑–∞ –æ–±—ñ–¥–Ω—ñ–º —Å—Ç–æ–ª–æ–º.'),
  ('–Ø–∫—â–æ –± –≥—Ä–æ—à—ñ –º–æ–∂–Ω–∞ –±—É–ª–æ –∫—É–ø–∏—Ç–∏, —è –±–∏ –∫—É–ø–∏–≤ –±–∞–≥–∞—Ç–æ –≥—Ä–æ—à–µ–π.'),
  ('–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —É—Å–ø—ñ—Ö - —Ü–µ –∫–æ–ª–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç–∏ –∫–∞–≤—É –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å—É –Ω–∞ –±–∞–Ω–∫—ñ–≤—Å—å–∫–æ–º—É —Ä–∞—Ö—É–Ω–∫—É.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ —Ç–µ, —â–æ –∑–º—É—à—É—î –Ω–∞—Å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, –∞–ª–µ —Ç–∞–∫–æ–∂ –∑–º—É—à—É—î –Ω–∞—Å –ø–∏—Ç–∏.'),
  ('–§—ñ–Ω–∞–Ω—Å–∏ - —Ü–µ –º–æ–≤–∞, —è–∫—É –Ω–µ –º–æ–∂–Ω–∞ —Ä–æ–∑–º–æ–≤–ª—è—Ç–∏ –∑ –ø–æ—Ä–æ–∂–Ω—å–æ—é –∫–∏—à–µ–Ω–µ—é.'),
  ('–Ø–∫—â–æ –≥—Ä–æ—à—ñ –Ω–µ —Ä–æ–±–ª—è—Ç—å –≤–∞—Å —â–∞—Å–ª–∏–≤–∏–º–∏, –≤–∏ –ø—Ä–æ—Å—Ç–æ –Ω–µ –∑–Ω–∞—î—Ç–µ, —è–∫ —ó—Ö –≤–∏—Ç—Ä–∞—Ç–∏—Ç–∏.'),
  ('–Ø–∫—â–æ –± –±–∞–Ω–∫ –≤—ñ–¥–º–æ–≤–∏–≤ –º–µ–Ω—ñ –≤ –∫—Ä–µ–¥–∏—Ç—ñ —â–µ —Ä–∞–∑, —è –¥—É–º–∞—é, —è –ø—Ä–æ—Å—Ç–æ —Ä–æ–∑–≥—Ä—ñ–±–∞–≤—Å—è –Ω–∞ —Å—Ç–æ–ª—ñ.'),
  ('–ö—Ä–µ–¥–∏—Ç - —Ü–µ —Ç–æ–π –º–æ–º–µ–Ω—Ç, –∫–æ–ª–∏ –±–∞–Ω–∫ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º –≤—ñ–¥–∫–ª–∞—Å—Ç–∏ —Ä–æ–∑–≥—Ä–æ–º –Ω–∞ –º–∞–π–±—É—Ç–Ω—î.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ –Ω–µ —î–¥–∏–Ω–∞ —Ä—ñ—á, —è–∫—É –±–∞–Ω–∫–∏ –º–æ–∂—É—Ç—å –≤–∞–º –≤—ñ–¥–º–æ–≤–∏—Ç–∏.'),
  ('–ë–∞–Ω–∫—ñ—Ä–∏ - —Ü–µ —Ç—ñ, —Ö—Ç–æ –ø–æ–∑–∏—á–∞—î –≤–∞–º –ø–∞—Ä–∞—Å–æ–ª—å–∫—É, –∫–æ–ª–∏ —Å–æ–Ω—Ü–µ —Å—è—î, —ñ –∑–∞–±–∏—Ä–∞—é—Ç—å, –∫–æ–ª–∏ –¥–æ—â –ª–ª—î.'),
  ('–Ø –≤—ñ–¥–∫—Ä–∏–≤ –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Ä–∞—Ö—É–Ω–æ–∫ —É –±–∞–Ω–∫—É. –í–æ–Ω–∏ –≤—á–∏–ª–∏ –º–µ–Ω–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≥—Ä–æ—à—ñ - –ø—Ä–æ—Å—Ç–æ –Ω–µ —É –Ω—å–æ–º—É.'),
  ('–Ø–∫—â–æ –±–∞–Ω–∫ –≤—ñ–¥–∫—Ä–∏–≤ –¥–ª—è –º–µ–Ω–µ —Ä–∞—Ö—É–Ω–æ–∫, —Ü–µ –≤–∂–µ —Å–º—ñ—à–Ω–æ, —è–∫—â–æ –± —è –≤–∂–µ —â–æ—Å—å –º–∞–≤, —è –± –∑–∞—Å–º—ñ—Ç–∏–≤—Å—è.'),
  ('–£ –∫–æ–∂–Ω–æ–≥–æ —Å–≤—ñ–π —Å–æ–±—ñ –±–∞–Ω–∫, –ø–æ–∫–∏ –Ω–µ –≤–∏—è–≤–ª—è—î—Ç—å—Å—è, —â–æ –±–∞–Ω–∫ - —Ü–µ —Ç–æ–π, —Ö—Ç–æ –º–∞—î –≤–∞—Å.'),
  ('–Ø –± –Ω–∞–∑–≤–∞–≤ –±–∞–Ω–∫—ñ—Ä–∞ –¥—Ä—É–∑—è–Ω–∫–æ—é, –∞–ª–µ –¥—Ä—É–∑—ñ –Ω–µ –∑–±–∏—Ä–∞—é—Ç—å –≤—ñ–¥—Å–æ—Ç–∫–∏.'),
  ('–ö–æ–ª–∏ –≤–∏ –±–µ—Ä–µ—Ç–µ –∫—Ä–µ–¥–∏—Ç —É –±–∞–Ω–∫—É, –≤–∏ –∫—É–ø—É—î—Ç–µ –∫—ñ–ª—å–∫–∞ —Ä–æ–∫—ñ–≤ –±–µ–∑—Å–æ–Ω–Ω–∏—Ö –Ω–æ—á–µ–π.'),
  ('–ë–∞–Ω–∫–∏ - —Ü–µ –º—ñ—Å—Ü–µ, –¥–µ –≤–∏ –∑–∞–ø–∏—Ç—É—î—Ç–µ –ø—Ä–æ –∫—Ä–µ–¥–∏—Ç —ñ –≤–∞–º –¥–∞—é—Ç—å –∫–Ω–∏–∂–∫—É –±–∞–∂–∞–Ω—å –∑ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∞–º–∏.'),
  ('–©–æ–± –∑–Ω–∞–π—Ç–∏ –±–∞–Ω–∫–æ–º–∞—Ç, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –≥—Ä–æ—à—ñ, —â–æ–± –ø—Ä–∏–¥–±–∞—Ç–∏ –º–æ–±—ñ–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç —Ç–∞ —à—É–∫–∞—Ç–∏ –≤ Google Maps.'),
  ('–ë–∞–Ω–∫—ñ—Ä–∏ - —Ü–µ —î–¥–∏–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—ñ—è, –¥–µ –≤–æ–Ω–∏ –ø–∏—Ç–∞—é—Ç—å –≤–∞—Å, —Å–∫—ñ–ª—å–∫–∏ —É –≤–∞—Å –≥—Ä–æ—à–µ–π, —ñ –≤–∞–º –¥–æ–≤–æ–¥–∏—Ç—å—Å—è —ó–º –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ —Ç–µ, –∑–∞—Ä–∞–¥–∏ —á–æ–≥–æ –±–∞–≥–∞—Ç–æ –ª—é–¥–µ–π —ñ–¥—É—Ç—å –Ω–∞ —Ä–æ–±–æ—Ç—É, —ñ–Ω—à—ñ —Ä–æ–±–ª—è—Ç—å –≤–µ—Å—ñ–ª—å–Ω—ñ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó.'),
  ('–ë–∞–Ω–∫—ñ—Ä–∏ - —Ü–µ —Ç—ñ, —Ö—Ç–æ –Ω–∞–π–±—ñ–ª—å—à–µ –±–∞–≥–∞—î—Ç—å—Å—è –∑–∞ –≤–∞—à—É —Ñ—ñ–Ω–∞–Ω—Å–æ–≤—É —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å... –∫–æ–ª–∏ –≤–∏ –≤ —ó—Ö –±–æ—Ä–≥–∞—Ö.'),
  ('–ì—Ä–æ—à—ñ - —Ü–µ –∫–æ—Ä—ñ–Ω—å –±–∞–≥–∞—Ç—å–æ—Ö –±—ñ–¥, –∞–ª–µ –≤–æ–Ω–∏ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –ø–æ–∫—Ä–∏—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ –∞–¥–≤–æ–∫–∞—Ç–∞.'),
  ('–Ø–∫—â–æ –± –±–∞–Ω–∫—ñ—Ä —Ä–æ–∑—É–º—ñ–≤ –≥—Ä–æ—à—ñ, –≤—ñ–Ω –±–∏ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞–≤ —É –±–∞–Ω–∫—É, –∞ –ø–µ—Ä–µ–ø—Ä–æ—à—É–≤–∞–≤ –±–∏ –Ω–∞—Å —É —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ñ.'),
  ('–í–∞—à –±–∞–Ω–∫ –∑–∞–≤–∂–¥–∏ –≥–æ—Ç–æ–≤–∏–π –≤–∞—Å –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏... –Ω–∞ –±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥—Ä–æ—à–µ–π, –Ω—ñ–∂ —É –≤–∞—Å —î.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ —Ä–æ–±–∏—Ç–∏ –≥—Ä–æ—à—ñ —ñ –∑–∞—Ç—Ä–∞—Ç–∏—Ç–∏ —ó—Ö, –ø–µ—Ä—à –Ω—ñ–∂ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ –≤–æ–Ω–∏ –±—É–ª–∏.'),
  ('–Ø –≤—ñ–¥–∫—Ä–∏–≤ —Å–≤—ñ–π –±—ñ–∑–Ω–µ—Å. –¢–µ–ø–µ—Ä —è –º–∞—é –¥–≤–∞ –¥–∂–æ–±–∏ - –æ–¥–∏–Ω –¥–ª—è –≥—Ä–æ—à–µ–π, —ñ–Ω—à–∏–π –¥–ª—è –±–æ—Ä–≥—ñ–≤.'),
  ('–Ø–∫—â–æ –≤–∏ –Ω–µ –≥–æ—Ç–æ–≤—ñ –≤—ñ–¥–¥–∞—Ç–∏ —Å–≤—ñ–π –æ—Ä–≥–∞–Ω—ñ–∑–º –±—ñ–∑–Ω–µ—Å—É, –≤–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –∑–∞–Ω–∞–¥—Ç–æ –¥–æ–±—Ä–µ –≤–∏–≥–ª—è–¥–∞—î—Ç–µ.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ —è–∫ –≥—ñ—Ä–∫–∞ —à–æ–∫–æ–ª–∞–¥–∫–∞: —Å–æ–ª–æ–¥–∫–∞ –Ω–∞ –ø–æ—á–∞—Ç–∫—É, –∞–ª–µ –ø–æ—Ç—ñ–º –∑–∞–ª–∏—à–∞—î –ø—ñ—Å–ª—è—Å–º–∞–∫.'),
  ('–ö–æ–ª–∏ –≤–∞—à –±—ñ–∑–Ω–µ—Å —ñ–¥–µ –Ω–∞ —Å–ø–∞–¥, –≤–∏ —Å—Ç–∞—î—Ç–µ –µ–∫—Å–ø–µ—Ä—Ç–æ–º –∑ —Ä–æ–∑–≤–∞–≥ —Ç–∞ –º—É–∑–∏–∫–∏ –Ω–∞ —Ä–æ–±–æ—á–æ–º—É –º—ñ—Å—Ü—ñ.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ —è–∫ —ñ–≥—Ä–∞—à–∫–∞ "–ú–æ–Ω–æ–ø–æ–ª—ñ—è", –∞–ª–µ –≥—Ä–æ—à—ñ –≤–∏—Ç—Ä–∞—á–∞—é—Ç—å—Å—è —Ä–µ–∞–ª—å–Ω—ñ.'),
  ('–£ –±—ñ–∑–Ω–µ—Å—ñ –Ω–µ–º–∞—î –∂–æ–¥–Ω–∏—Ö –æ–±–º–µ–∂–µ–Ω—å, –æ–∫—Ä—ñ–º –æ–±–º–µ–∂–µ–Ω—å –≤ –±—é–¥–∂–µ—Ç—ñ.'),
  ('–Ø –º—Ä—ñ—é –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å–≤—ñ–π –±—ñ–∑–Ω–µ—Å. –Ü–Ω–∫–æ–ª–∏ —è –Ω–∞–≤—ñ—Ç—å –ø—Ä–æ–∫–∏–¥–∞—é—Å—è —ñ —Ä–æ–±–ª—é –∫–∞–≤—É.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ —è–∫ –≤–∏—Ö–æ–≤–∞–Ω–Ω—è –¥—ñ—Ç–µ–π: –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–Ω–∞—î—à, —è–∫ —Ü–µ –≤–∞–∂–∫–æ, –¥–æ–∫–∏ –Ω–µ —Å–ø—Ä–æ–±—É—î—à.'),
  ('–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –∑–Ω–∞—Ç–∏, —á–æ–º—É –±—ñ–∑–Ω–µ—Å –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è "–≥—Ä–æ—à—ñ", –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∞.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ –∑–∞—Ä–æ–±–∏—Ç–∏ –≥—Ä–æ—à—ñ, —â–æ–± –≤–æ–Ω–∏ –º–æ–≥–ª–∏ –∑–Ω–∏–∫–Ω—É—Ç–∏ –≤ –≤–∏—Ç—Ä–∞—Ç–∏.'),
  ('–í –±—ñ–∑–Ω–µ—Å—ñ –Ω–∞–π–≥–æ–ª–æ–≤–Ω—ñ—à–µ - –±—É—Ç–∏ –≥–æ—Ç–æ–≤–∏–º –≤—ñ–¥–¥–∞—Ç–∏ –≥—Ä–æ—à—ñ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ —ó—Ö –∑–∞—Ä–æ–±–∏—Ç–∏.'),
  ('–Ø–∫—â–æ –±—ñ–∑–Ω–µ—Å –±—É–≤ –±–∏ –ª–µ–≥–∫–æ—é —Å–ø—Ä–∞–≤–æ—é, –≤—Å—ñ –±–∏ —Ü–∏–º –∑–∞–π–º–∞–ª–∏—Å—è, –∞–ª–µ –≤–æ–Ω–∏ –± –Ω–µ –∑–∞—Ä–æ–±–ª—è–ª–∏ –≥—Ä–æ—à–µ–π.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ –º–æ–≤–∞ —Ü–∏—Ñ—Ä —ñ –∫–∞–≤–æ–≤–∏—Ö –ø–µ—Ä–µ—Ä–≤.'),
  ('–ö–æ–ª–∏ –≤–∏ –≤–µ–¥–µ—Ç–µ —Å–≤—ñ–π –±—ñ–∑–Ω–µ—Å, –≤–∏ –∑–Ω–∞—î—Ç–µ, —â–æ –∑–∞–≤—Ç—Ä–∞—à–Ω—ñ–π –¥–µ–Ω—å –∑–∞–≤–∂–¥–∏ –±—É–¥–µ —Ä—É—Ö–∞—Ç–∏—Å—è —à–≤–∏–¥—à–µ, –Ω—ñ–∂ –≤–∏.'),
  ('–ë—ñ–∑–Ω–µ—Å - —Ü–µ —è–∫ –≥—Ä–∞ –≤ —à–∞—Ö–∏, –∞–ª–µ —à–∞—Ö–∏ –∑ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç—å–º–∞ —Ñ—ñ–≥—É—Ä–∞–º–∏ —ñ –Ω—É–ª—å–æ–≤–∏–º–∏ –ø–∞—É–∑–∞–º–∏.'),
  ('–ñ–∏—Ç—Ç—è - —Ü–µ –≥—Ä–∞, –∞ –±—ñ–∑–Ω–µ—Å - —Ü–µ —Å–ø–æ—Å—ñ–± –≤–∏–≥—Ä–∞—Ç–∏ —ó—ó, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Å–≤–æ—ó –≥—Ä–æ—à—ñ.') ;

CREATE TABLE transactions (
  id BIGSERIAL PRIMARY KEY NOT NULL,
  sender_id BIGINT REFERENCES users(id) ON DELETE CASCADE,
  receiver_id BIGINT REFERENCES users(id) ON DELETE CASCADE,
  amount INTEGER NOT NULL,
  comment TEXT,
  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);

CREATE INDEX idx_transactions ON transactions (sender_id, receiver_id);

CREATE TABLE invoices (
  id BIGSERIAL PRIMARY KEY NOT NULL,
  transaction_id BIGINT REFERENCES transactions(id) ON DELETE SET NULL,
  user_id BIGINT REFERENCES users(id) ON DELETE CASCADE
);

CREATE INDEX idx_invoices ON invoices (transaction_id, user_id);

CREATE TABLE invoice_items (
  id BIGSERIAL PRIMARY KEY NOT NULL,
  invoice_id BIGINT NOT NULL REFERENCES invoices(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  price INTEGER NOT NULL,
  quantity INTEGER NOT NULL,
  description TEXT
);

CREATE INDEX idx_invoice_items ON invoice_items (invoice_id);

CREATE TABLE products (
  id BIGSERIAL PRIMARY KEY NOT NULL,
  user_id BIGINT NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  description TEXT,
  stack INTEGER CHECK (stack BETWEEN 1 AND 64) NOT NULL,
  price INTEGER NOT NULL,
  quantity INTEGER NOT NULL
);

CREATE INDEX idx_products ON products (user_id);

CREATE OR REPLACE FUNCTION calculate_balance(user_id BIGINT) RETURNS INTEGER AS $$
DECLARE
  balance INTEGER;
BEGIN
  SELECT COALESCE(SUM(
    CASE
      WHEN sender_id = user_id THEN -amount
      ELSE amount
    END), 0)
  INTO balance
  FROM transactions
  WHERE user_id IN (sender_id, receiver_id);

  RETURN balance;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION perform_transaction(
  sender_id BIGINT,
  receiver_id BIGINT,
  amount INTEGER,
  comment TEXT,
  OUT status TEXT,
  OUT transaction_id BIGINT
) AS $$
DECLARE
BEGIN
  -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ –≤—ñ—Ä–Ω–∞ —Å—É–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
  IF amount < 1 THEN
    status := 'INVALID_AMOUNT';
    RETURN;
  END IF;

  -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ —ñ –æ—Ç—Ä–∏–º—É–≤–∞—á –Ω–µ —î –æ–¥–Ω—ñ—î—é —ñ —Ç—ñ—î—é –∂ —Å–∞–º–æ—é –æ—Å–æ–±–æ—é
  IF sender_id = receiver_id THEN
    status := 'INVALID_OPERATION';
    RETURN;
  END IF;

  IF sender_id IS NOT NULL THEN
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ —ñ—Å–Ω—É—î
    IF (SELECT COUNT(*) FROM users WHERE id = sender_id) = 0 THEN
      status := 'SENDER_NOT_FOUND';
      RETURN;
    END IF;
    
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π
    IF (SELECT banned FROM users WHERE id = sender_id) THEN
      status := 'SENDER_IS_BANNED';
      RETURN;
    END IF;
  
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—É –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
    IF calculate_balance(sender_id) < amount THEN
      status := 'NO_COST';
      RETURN;
    END IF;
  END IF;

  IF receiver_id IS NOT NULL THEN
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –æ—Ç—Ä–∏–º—É–≤–∞—á —ñ—Å–Ω—É—î
    IF (SELECT COUNT(*) FROM users WHERE id = receiver_id) = 0 THEN
      status := 'RECEIVER_NOT_FOUND';
      RETURN;
    END IF;
    
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –æ—Ç—Ä–∏–º—É–≤–∞—á –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π
    IF (SELECT banned FROM users WHERE id = receiver_id) THEN
      status := 'RECEIVER_IS_BANNED';
      RETURN;
    END IF;
  END IF;

  -- –°—Ç–≤–æ—Ä—é—î–º–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —ñ –æ—Ç—Ä–∏–º—É—î–º–æ —ó—ó ID
  INSERT INTO transactions (sender_id, receiver_id, amount, comment)
  VALUES (sender_id, receiver_id, amount, comment)
  RETURNING id INTO transaction_id;
  
  -- –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —É—Å–ø—ñ—à–Ω—É –æ–ø–µ—Ä–∞—Ü—ñ—é —Ç–∞ ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
  status := 'SUCCESS';
END;
$$ LANGUAGE plpgsql;

CREATE TYPE invoice_item_data AS (
  name TEXT,
  price INTEGER,
  quantity INTEGER,
  description TEXT
);

CREATE OR REPLACE FUNCTION create_invoice(
  user_id BIGINT,
  items invoice_item_data[],
  OUT status TEXT,
  OUT invoice_id BIGINT
) AS $$
BEGIN
  -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ—Å–Ω—É—î
  IF (SELECT COUNT(*) FROM users WHERE id = user_id) = 0 THEN
    status := 'USER_NOT_FOUND';
    RETURN;
  END IF;

  -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π
  IF (SELECT banned FROM users WHERE id = user_id) THEN
    status := 'USER_BANNED';
    RETURN;
  END IF;

  -- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ items
  IF NOT (SELECT bool_and(price > 0 AND quantity > 0 AND name IS NOT NULL) FROM UNNEST(items) AS i) THEN
    status := 'INVALID_FORMAT';
    RETURN;
  END IF;

  -- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–≤–æ–π—Å—É
  INSERT INTO invoices (user_id)
  VALUES (user_id)
  RETURNING id INTO invoice_id;

  INSERT INTO invoice_items (invoice_id, name, price, quantity, description)
  SELECT invoice_id, i.name, i.price, i.quantity, i.description
  FROM UNNEST(items) AS i;

  status := 'SUCCESS';
END;
$$ LANGUAGE plpgsql;
