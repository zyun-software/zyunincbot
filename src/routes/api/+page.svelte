<script lang="ts">
	import { goto } from '$app/navigation';
	import { PUBLIC_URL_API } from '$env/static/public';
	import { showBackButton } from '$lib/utilities';
	import { onMount } from 'svelte';

	export let data;
	export let form;

	const token = data?.token ?? form?.token ?? '';

	onMount(() => showBackButton(() => goto('/')));
</script>

<div class="p-4">
	<form method="post" action="?/genetateToken" class="mb-4">
		<fieldset class="grid grid-cols-3 items-center mb-2">
			<label for="token">ü§ñ –¢–æ–∫–µ–Ω</label>
			<input
				id="token"
				name="token"
				type="text"
				value={token}
				readonly
				class="p-2 col-span-2 bg-tg-secondary-bg-color rounded w-full"
				placeholder="API —Ç–æ–∫–µ–Ω"
				required
			/>
		</fieldset>
		<button class="w-full p-2 rounded bg-tg-button-color"
			>–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ {token === '' ? '' : '–Ω–æ–≤–∏–π '}—Ç–æ–∫–µ–Ω</button
		>
	</form>
	{#if token.length > 0}
		–ü–µ—Ä–µ–∫–∞–∑ –∫–æ—à—Ç—ñ–≤
		<pre class="rounded p-2 bg-tg-secondary-bg-color overflow-auto mb-2">
curl --location '{PUBLIC_URL_API}/transfer-money' \
--header 'Token: {token}' \
--header 'Content-Type: application/json' \
--data '&#123;
	"receiver": "Ziozyun",
	"amount": "115",
	"comment": "–ù–∞ —Ü—É–∫–µ—Ä–∫–∏"
&#125;'</pre>
		–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–µ–∫—É
		<pre class="rounded p-2 bg-tg-secondary-bg-color overflow-auto mb-2">
curl --location '{PUBLIC_URL_API}/create-invoice' \
--header 'Token: {token}' \
--header 'Content-Type: application/json' \
--data '[
	&#123;
		"name": "–î—ñ–∞–º–∞–Ω—Ç–∏",
		"price": 200,
		"quantity": 1,
		"description": "–°—Ç–∞–∫ –¥—ñ–∞–º–∞–Ω—Ç—ñ–≤"
	&#125;
]'</pre>
		–ü–µ—Ä–µ–≥–ª—è–¥ —á–µ–∫—É
		<pre class="rounded p-2 bg-tg-secondary-bg-color overflow-auto mb-2">
curl --location '{PUBLIC_URL_API}/find-invoice' \
--header 'Token: {token}' \
--header 'Content-Type: application/json' \
--data '&#123;
	"id": "1"
&#125;'</pre>
	{/if}
</div>
